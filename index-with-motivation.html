<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é©å¿œå‹ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // æ–°ã—ã„æ–‡è§£æ”¾ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const NewSentenceDialog = ({ show, sentence, onClose }) => {
      if (!show) return null;

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-purple-50 to-pink-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full text-center'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6'
          }, 'ğŸ“š æ–°ã—ã„æ–‡ã‚’è§£æ”¾ã—ã¾ã—ãŸï¼'),

          React.createElement('div', {
            className: 'mb-6'
          },
            React.createElement('div', {
              className: 'text-4xl mb-4'
            }, 'âœ¨'),

            React.createElement('div', {
              className: 'p-4 bg-blue-50 border border-blue-200 rounded-lg mb-4'
            },
              React.createElement('p', {
                className: 'text-lg text-gray-800 font-medium leading-relaxed'
              }, sentence)
            ),

            React.createElement('div', {
              className: 'text-sm text-gray-600'
            }, 'ä½œæ¥­ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼æ¬¡ã®æ–‡ãŒæ°—ã«ãªã‚Šã¾ã™ã­...')
          ),

          React.createElement('button', {
            onClick: onClose,
            className: 'w-full bg-purple-500 hover:bg-purple-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
          }, 'é–‰ã˜ã‚‹')
        )
      );
    };

    // èª­æ›¸è¨˜éŒ²ç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const ReadingHistoryDialog = ({ show, literaryProgress, literaryWorks, onClose, onSelectWork, onDeleteData }) => {
      if (!show) return null;

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-indigo-50 to-purple-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6 text-center'
          }, 'ğŸ“š èª­æ›¸è¨˜éŒ²'),

          React.createElement('div', {
            className: 'space-y-3 mb-6'
          },
            // èµ°ã‚Œãƒ¡ãƒ­ã‚¹
            React.createElement('button', {
              onClick: () => onSelectWork('hashire_melos'),
              className: 'w-full p-4 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-left transition-colors'
            },
              React.createElement('div', {
                className: 'flex justify-between items-center'
              },
                React.createElement('div', {},
                  React.createElement('div', {
                    className: 'font-medium text-gray-800'
                  }, 'èµ°ã‚Œãƒ¡ãƒ­ã‚¹'),
                  React.createElement('div', {
                    className: 'text-sm text-gray-600'
                  }, 'å¤ªå®°æ²»')
                ),
                React.createElement('div', {
                  className: 'text-sm font-medium text-blue-600'
                }, `${literaryProgress.currentSentence + 1}/${literaryWorks.hashire_melos.totalSentences}æ–‡`)
              )
            )
          ),
          React.createElement('div', {
            className: 'mb-4 p-3 bg-red-50 border border-red-200 rounded-lg'
          },
            React.createElement('button', {
              onClick: onDeleteData,
              className: 'w-full py-2 px-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm'
            }, 'ğŸ“š èª­æ›¸ãƒ‡ãƒ¼ã‚¿å‰Šé™¤')
          ),

          React.createElement('button', {
            onClick: onClose,
            className: 'w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
          }, 'é–‰ã˜ã‚‹')
        )
      );
    };

    // ä½œå“èª­æ›¸ç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const WorkReadingDialog = ({ show, selectedWork, literaryWorks, literaryProgress, onBack, onClose }) => {
      if (!show || !selectedWork) return null;

      const work = literaryWorks[selectedWork];

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-amber-50 to-orange-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-lg w-full max-h-[80vh] overflow-y-auto'
        },
          React.createElement('div', {
            className: 'text-center mb-6'
          },
            React.createElement('h2', {
              className: 'text-2xl font-bold text-gray-800 mb-2'
            }, work.title),
            React.createElement('p', {
              className: 'text-gray-600'
            }, `${work.author} è‘—`),
            React.createElement('div', {
              className: 'text-sm text-blue-600 mt-2'
            }, `èª­äº†: ${literaryProgress.currentSentence + 1}/${work.totalSentences}æ–‡`)
          ),

          React.createElement('div', {
            className: 'space-y-4 mb-6'
          },
            // è§£æ”¾æ¸ˆã¿ã®æ–‡ã‚’é †ç•ªã«è¡¨ç¤º
            ...Array.from({ length: literaryProgress.currentSentence + 1 }, (_, index) =>
              React.createElement('div', {
                key: index,
                className: 'p-4 bg-amber-50 border-l-4 border-amber-400 rounded-r-lg'
              },
                React.createElement('div', {
                  className: 'text-sm text-amber-600 mb-1'
                }, `ç¬¬${index + 1}æ–‡`),
                React.createElement('p', {
                  className: 'text-gray-800 leading-relaxed'
                }, work.sentences[index])
              )
            ),

            // ã¾ã è§£æ”¾ã•ã‚Œã¦ã„ãªã„æ–‡ãŒã‚ã‚‹å ´åˆã®è¡¨ç¤º
            literaryProgress.currentSentence + 1 < work.totalSentences &&
            React.createElement('div', {
              className: 'p-4 bg-gray-100 border-l-4 border-gray-300 rounded-r-lg text-center'
            },
              React.createElement('div', {
                className: 'text-sm text-gray-500 mb-1'
              }, `ç¬¬${literaryProgress.currentSentence + 2}æ–‡`),
              React.createElement('p', {
                className: 'text-gray-500 italic'
              }, 'ï¼Ÿï¼Ÿï¼Ÿ'),
              React.createElement('p', {
                className: 'text-xs text-gray-400 mt-2'
              }, 'ä½œæ¥­ã‚’å®Œäº†ã™ã‚‹ã¨ç¶šããŒèª­ã‚ã¾ã™')
            )
          ),

          React.createElement('div', {
            className: 'flex space-x-3'
          },
            React.createElement('button', {
              onClick: onBack,
              className: 'flex-1 bg-amber-500 hover:bg-amber-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
            }, 'â† ä½œå“ä¸€è¦§ã«æˆ»ã‚‹'),

            React.createElement('button', {
              onClick: onClose,
              className: 'flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
            }, 'é–‰ã˜ã‚‹')
          )
        )
      );
    };

    // ãƒœã‚¹äºˆå‘Šç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const BattlePreviewDialog = ({ show, boss, playerFood, playerEquipment, onProceed, onEscape }) => {
      if (!show || !boss) return null;

      const getEffectiveAttribute = (bossAttribute) => {
        switch (bossAttribute) {
          case 'fire': return 'water';
          case 'water': return 'wood';
          case 'wood': return 'fire';
          default: return 'fire';
        }
      };

      const getFoodCount = (attribute) => {
        switch (attribute) {
          case 'fire': return playerFood.fire;
          case 'water': return playerFood.water;
          case 'wood': return playerFood.wood;
          default: return 0;
        }
      };

      const effectiveAttribute = getEffectiveAttribute(boss.attribute);

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-red-50 to-purple-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full text-center'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6'
          }, 'âš”ï¸ ãƒœã‚¹å‡ºç¾ï¼'),

          React.createElement('div', {
            className: 'mb-6'
          },
            React.createElement('div', {
              className: 'text-6xl mb-4'
            }, boss.emoji),

            React.createElement('h3', {
              className: 'text-xl font-bold text-gray-800 mb-2'
            }, boss.name),

            React.createElement('p', {
              className: 'text-gray-600 mb-4'
            }, boss.description),

            React.createElement('div', {
              className: 'bg-red-50 border border-red-200 rounded-lg p-4'
            },
              React.createElement('div', {
                className: 'text-sm text-gray-700 mb-2'
              }, `å±æ€§: ${boss.attribute === 'fire' ? 'ğŸ”¥ ç«' : boss.attribute === 'water' ? 'ğŸ’§ æ°´' : 'ğŸŒ¿ æœ¨'}`),
              React.createElement('div', {
                className: 'text-sm text-gray-700 mb-2'
              }, `HP: ${boss.hp} / æ”»æ’ƒåŠ›: ${boss.attack}`),
              React.createElement('div', {
                className: 'text-sm font-medium text-red-600'
              }, `å¼±ç‚¹: ${effectiveAttribute === 'fire' ? 'ğŸ”¥ ç«' : effectiveAttribute === 'water' ? 'ğŸ’§ æ°´' : 'ğŸŒ¿ æœ¨'}ã‚¨ã‚µã§æœ‰åˆ©ï¼`)
            )
          ),

          React.createElement('div', {
            className: 'mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg'
          },
            React.createElement('h4', {
              className: 'font-medium text-gray-800 mb-2'
            }, 'ç¾åœ¨ã®æˆ¦åŠ›'),
            React.createElement('div', {
              className: 'text-sm text-gray-600'
            }, `æœ‰åŠ¹ã‚¨ã‚µ(${effectiveAttribute === 'fire' ? 'ğŸ”¥' : effectiveAttribute === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'}): ${getFoodCount(effectiveAttribute)}å€‹`),
            React.createElement('div', {
              className: 'text-sm text-gray-600'
            }, `è£…å‚™é˜²å¾¡åŠ›: ${playerEquipment}`)
          ),

          React.createElement('div', {
            className: 'space-y-3'
          },
            React.createElement('button', {
              onClick: onProceed,
              className: 'w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
            }, 'æˆ¦é—˜æº–å‚™ã«é€²ã‚€'),

            React.createElement('button', {
              onClick: onEscape,
              className: 'w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
            }, 'é€ƒã’ã‚‹')
          )
        )
      );
    };

    // æˆ¦é—˜æº–å‚™ç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const BattlePreparationDialog = ({ show, boss, playerFood, playerEquipment, onBattle, onBack }) => {
      if (!show || !boss) return null;

      const getEffectiveAttribute = (bossAttribute) => {
        switch (bossAttribute) {
          case 'fire': return 'water';
          case 'water': return 'wood';
          case 'wood': return 'fire';
          default: return 'fire';
        }
      };

      const getFoodCount = (attribute) => {
        switch (attribute) {
          case 'fire': return playerFood.fire;
          case 'water': return playerFood.water;
          case 'wood': return playerFood.wood;
          default: return 0;
        }
      };

      const calculatePlayerPower = () => {
        const effectiveAttribute = getEffectiveAttribute(boss.attribute);
        const effectiveFoodCount = getFoodCount(effectiveAttribute);
        return {
          hp: effectiveFoodCount,
          attack: Math.floor(effectiveFoodCount * 1.5),
          defense: playerEquipment,
          effectiveAttribute,
          effectiveFoodCount
        };
      };

      const simulateBattle = (playerPower) => {
        const damageReceived = Math.max(0, boss.attack - playerPower.defense);
        const playerSurvives = playerPower.hp > damageReceived;
        const canDefeatBoss = playerPower.attack >= boss.hp;
        return {
          victory: playerSurvives && canDefeatBoss,
          damageReceived,
          playerSurvives,
          canDefeatBoss,
          playerPower,
          boss
        };
      };

      const playerPower = calculatePlayerPower();
      const battleSim = simulateBattle(playerPower);

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-blue-50 to-green-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6 text-center'
          }, 'âš”ï¸ æˆ¦é—˜æº–å‚™'),

          React.createElement('div', {
            className: 'space-y-4'
          },
            React.createElement('div', {
              className: 'p-4 bg-blue-50 border border-blue-200 rounded-lg'
            },
              React.createElement('h3', {
                className: 'font-medium text-gray-800 mb-2'
              }, 'ã‚ãªãŸã®æˆ¦åŠ›'),
              React.createElement('div', {
                className: 'text-sm text-gray-600 space-y-1'
              },
                React.createElement('div', {}, `HP: ${playerPower.hp}`),
                React.createElement('div', {}, `æ”»æ’ƒåŠ›: ${playerPower.attack}`),
                React.createElement('div', {}, `é˜²å¾¡åŠ›: ${playerPower.defense}`)
              )
            ),

            React.createElement('div', {
              className: `p-4 border rounded-lg ${battleSim.victory ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`
            },
              React.createElement('h3', {
                className: 'font-medium text-gray-800 mb-2'
              }, 'æˆ¦é—˜äºˆæ¸¬'),
              React.createElement('div', {
                className: 'text-sm space-y-1'
              },
                React.createElement('div', {
                  className: battleSim.playerSurvives ? 'text-green-600' : 'text-red-600'
                }, `ç”Ÿå­˜: ${battleSim.playerSurvives ? 'âœ…' : 'âŒ'} (è¢«ãƒ€ãƒ¡ãƒ¼ã‚¸: ${battleSim.damageReceived})`),
                React.createElement('div', {
                  className: battleSim.canDefeatBoss ? 'text-green-600' : 'text-red-600'
                }, `æ’ƒç ´: ${battleSim.canDefeatBoss ? 'âœ…' : 'âŒ'}`),
                React.createElement('div', {
                  className: `font-medium ${battleSim.victory ? 'text-green-600' : 'text-red-600'}`
                }, `çµæœ: ${battleSim.victory ? 'å‹åˆ©' : 'æ•—åŒ—'}`)
              )
            ),

            React.createElement('div', {
              className: 'space-y-3'
            },
              React.createElement('button', {
                onClick: () => onBattle(battleSim),
                className: 'w-full bg-red-500 hover:bg-red-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
              }, 'æˆ¦é—˜é–‹å§‹ï¼'),

              React.createElement('button', {
                onClick: onBack,
                className: 'w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
              }, 'æˆ»ã‚‹')
            )
          )
        )
      );
    };

    // æˆ¦é—˜çµæœç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const BattleResultDialog = ({ show, battleResult, bossName, onClose }) => {
      if (!show || !battleResult) return null;

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-yellow-50 to-orange-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full text-center'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6'
          }, battleResult.victory ? 'ğŸ‰ å‹åˆ©ï¼' : 'ğŸ’€ æ•—åŒ—...'),

          React.createElement('div', {
            className: 'mb-6'
          },
            React.createElement('div', {
              className: 'text-4xl mb-4'
            }, battleResult.victory ? 'ğŸ‘‘' : 'ğŸ’€'),

            React.createElement('p', {
              className: 'text-gray-600 mb-4'
            }, battleResult.victory ?
              `${bossName}ã‚’è¦‹äº‹ã«å€’ã—ã¾ã—ãŸï¼` :
              `${bossName}ã«æ•—ã‚Œã¾ã—ãŸ...`
            ),

            React.createElement('div', {
              className: 'text-sm text-gray-600 space-y-1'
            },
              React.createElement('div', {}, `ã‚ãªãŸã®HP: ${battleResult.playerPower.hp}`),
              React.createElement('div', {}, `å—ã‘ãŸãƒ€ãƒ¡ãƒ¼ã‚¸: ${battleResult.damageReceived}`),
              React.createElement('div', {}, `ä¸ãˆãŸãƒ€ãƒ¡ãƒ¼ã‚¸: ${battleResult.playerPower.attack}`)
            )
          ),

          React.createElement('div', {
            className: 'space-y-3'
          },
            React.createElement('button', {
              onClick: onClose,
              className: 'w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
            }, 'é–‰ã˜ã‚‹')
          )
        )
      );
    };

    // è£…å‚™ã‚¬ãƒãƒ£çµæœç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    const EquipmentGachaDialog = ({ show, gachaResult, currentEquipment, onEquip, onKeepCurrent, onDiscard }) => {
      if (!show || !gachaResult) return null;

      const isUpgrade = gachaResult.defense > currentEquipment;

      return React.createElement('div', {
        className: 'fixed inset-0 bg-gradient-to-br from-orange-50 to-yellow-100 flex items-center justify-center p-4 z-50'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-xl p-8 max-w-md w-full text-center'
        },
          React.createElement('h2', {
            className: 'text-2xl font-bold text-gray-800 mb-6'
          }, 'ğŸ° è£…å‚™ã‚¬ãƒãƒ£çµæœ'),

          React.createElement('div', {
            className: 'mb-6'
          },
            React.createElement('div', {
              className: 'text-4xl mb-4'
            }, 'âš”ï¸'),

            React.createElement('h3', {
              className: 'text-xl font-bold text-gray-800 mb-2'
            }, gachaResult.name),

            React.createElement('div', {
              className: 'p-4 bg-blue-50 border border-blue-200 rounded-lg mb-4'
            },
              React.createElement('div', {
                className: 'text-sm text-gray-700'
              }, `é˜²å¾¡åŠ›: +${gachaResult.defense}`),
              React.createElement('div', {
                className: 'text-sm text-gray-600 mt-1'
              }, `ä½¿ç”¨ã—ãŸã‚¨ã‚µ: ${gachaResult.usedFoodType === 'fire' ? 'ğŸ”¥' : gachaResult.usedFoodType === 'water' ? 'ğŸ’§' : 'ğŸŒ¿'} 1å€‹`)
            ),

            isUpgrade ?
              React.createElement('div', {
                className: 'p-3 bg-green-50 border border-green-200 rounded-lg mb-4'
              },
                React.createElement('p', {
                  className: 'text-green-700 font-medium'
                }, `é˜²å¾¡åŠ›ã‚¢ãƒƒãƒ—ï¼ ${currentEquipment} â†’ ${gachaResult.defense}`)
              ) :
              React.createElement('div', {
                className: 'p-3 bg-yellow-50 border border-yellow-200 rounded-lg mb-4'
              },
                React.createElement('p', {
                  className: 'text-yellow-700'
                }, `ç¾åœ¨ã®è£…å‚™ã®æ–¹ãŒå„ªç§€ã§ã™ (ç¾åœ¨: ${currentEquipment})`)
              )
          ),

          React.createElement('div', {
            className: 'space-y-3'
          },
            isUpgrade ?
              React.createElement('button', {
                onClick: onEquip,
                className: 'w-full bg-green-500 hover:bg-green-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
              }, 'è£…å‚™ã™ã‚‹') :
              React.createElement('div', {
                className: 'space-y-2'
              },
                React.createElement('button', {
                  onClick: onEquip,
                  className: 'w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
                }, 'ãã‚Œã§ã‚‚è£…å‚™ã™ã‚‹'),
                React.createElement('button', {
                  onClick: onDiscard,
                  className: 'w-full bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-6 rounded-xl transition-colors'
                }, 'è£…å‚™ã—ãªã„')
              )
          )
        )
      );
    };

    const AdaptivePomodoro = () => {
      // åŸºæœ¬çŠ¶æ…‹
      const [currentPhase, setCurrentPhase] = useState('idle');
      const [timeLeft, setTimeLeft] = useState(0);
      const [currentWorkDuration, setCurrentWorkDuration] = useState(5);
      const [sessionCount, setSessionCount] = useState(0);

      // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°åˆ¶å¾¡
      const [showReasonDialog, setShowReasonDialog] = useState(false);
      const [showContinueDialog, setShowContinueDialog] = useState(false);
      const [showBreakSuggestion, setShowBreakSuggestion] = useState(false);
      const [showTaskCompleteDialog, setShowTaskCompleteDialog] = useState(false);

      // ã‚¿ã‚¹ã‚¯æƒ…å ±
      const [reason, setReason] = useState('');
      const [currentTaskReason, setCurrentTaskReason] = useState('');
      const [taskResult, setTaskResult] = useState('');
      const [reasonHistory, setReasonHistory] = useState([]);

      // çµ±è¨ˆã¨ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
      const [totalWorkTime, setTotalWorkTime] = useState(0);
      const [totalExp, setTotalExp] = useState(0);
      const [level, setLevel] = useState(1);

      // ãã®ä»–ã®çŠ¶æ…‹
      const [isTimerFinished, setIsTimerFinished] = useState(false);
      const [workStartTime, setWorkStartTime] = useState(null);

      // æ–°ã—ãè¿½åŠ ï¼šã‚„ã‚‹æ°—ãƒ¢ãƒ¼ãƒ‰ç®¡ç†
      const [motivationMode, setMotivationMode] = useState('normal'); // 'normal', 'breathing', 'task-input', 'walk-suggestion'
      const [breathingPhase, setBreathingPhase] = useState('inhale'); // 'inhale', 'hold', 'exhale'
      const [breathingCycle, setBreathingCycle] = useState(0);
      const [passiveTask, setPassiveTask] = useState('');
      const [showPassiveTaskSubmit, setShowPassiveTaskSubmit] = useState(false);

      const [showWorkoutSuggestion, setShowWorkoutSuggestion] = useState(false);
      const [showEquipmentGacha, setShowEquipmentGacha] = useState(false);
      const [gachaResult, setGachaResult] = useState(null);

      // ãƒšãƒƒãƒˆé–¢é€£ã®çŠ¶æ…‹
      const [petLevel, setPetLevel] = useState(1);
      const [fireFood, setFireFood] = useState(0);    // ğŸ”¥ç«ã‚¨ã‚µ
      const [waterFood, setWaterFood] = useState(0);  // ğŸ’§æ°´ã‚¨ã‚µ
      const [woodFood, setWoodFood] = useState(0);    // ğŸŒ¿æœ¨ã‚¨ã‚µ

      const [petType, setPetType] = useState('egg');
      // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ç”¨ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
      const [showNewSentenceDialog, setShowNewSentenceDialog] = useState(false);
      const [newlyUnlockedSentence, setNewlyUnlockedSentence] = useState('');

      // æˆ¦é—˜ã‚·ã‚¹ãƒ†ãƒ é–¢é€£ã®çŠ¶æ…‹
      const [currentBoss, setCurrentBoss] = useState(null);
      const [battlePhase, setBattlePhase] = useState('none'); // 'none', 'preview', 'preparation', 'battle', 'result'
      const [playerEquipment, setPlayerEquipment] = useState(0); // é˜²å¾¡åŠ›
      const [battleResult, setBattleResult] = useState(null);

      // ä¼‘æ†©ã‚·ã‚¹ãƒ†ãƒ é–¢é€£
      const [isBreakTime, setIsBreakTime] = useState(false);
      const [breakTimeLeft, setBreakTimeLeft] = useState(0);

      // æ–°ã—ãè¿½åŠ ï¼šé’ç©ºæ–‡åº«ã‚·ã‚¹ãƒ†ãƒ ç”¨ã®çŠ¶æ…‹ç®¡ç†
      const [literaryProgress, setLiteraryProgress] = useState({
        currentWork: 'hashire_melos',  // ä»Šèª­ã‚“ã§ã„ã‚‹ä½œå“
        currentSentence: 0,            // ä»Šä½•æ–‡ç›®ã¾ã§èª­ã‚“ã ã‹
        completedWorks: [],            // èª­ã¿çµ‚ã‚ã£ãŸä½œå“ã®ãƒªã‚¹ãƒˆ
        totalReadSentences: 0          // ä»Šã¾ã§ã«èª­ã‚“ã æ–‡ã®ç·æ•°
      });
      // èª­æ›¸è¨˜éŒ²ã‚·ã‚¹ãƒ†ãƒ ç”¨ã®çŠ¶æ…‹
      const [showReadingHistory, setShowReadingHistory] = useState(false);
      const [selectedWork, setSelectedWork] = useState(null);

      const intervalRef = useRef(null);
      const breathingIntervalRef = useRef(null);
      const workDurations = [5, 6, 8, 10, 12, 15];

      // é’ç©ºæ–‡åº«ã®ä½œå“ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€åˆã¯èµ°ã‚Œãƒ¡ãƒ­ã‚¹ã ã‘ï¼‰
      const literaryWorks = {
        hashire_melos: {
          title: 'èµ°ã‚Œãƒ¡ãƒ­ã‚¹',
          author: 'å¤ªå®°æ²»',
          sentences: [
            "ãƒ¡ãƒ­ã‚¹ã¯æ¿€æ€’ã—ãŸã€‚",
            "å¿…ãšã€ã‹ã®é‚ªæ™ºæš´è™ã®ç‹ã‚’é™¤ã‹ãªã‘ã‚Œã°ãªã‚‰ã¬ã¨æ±ºæ„ã—ãŸã€‚",
            "ãƒ¡ãƒ­ã‚¹ã«ã¯æ”¿æ²»ãŒã‚ã‹ã‚‰ã¬ã€‚",
            "ãƒ¡ãƒ­ã‚¹ã¯ã€æ‘ã®ç‰§äººã§ã‚ã‚‹ã€‚",
            "ç¬›ã‚’å¹ãã€ç¾Šã¨éŠã‚“ã§æš®ã—ã¦æ¥ãŸã€‚"
            // ä»Šã¯ãƒ†ã‚¹ãƒˆç”¨ã«5æ–‡ã ã‘ï¼ˆå¾Œã§å¢—ã‚„ã—ã¾ã™ï¼‰
          ],
          totalSentences: 5  // å®Ÿéš›ã¯127æ–‡ãã‚‰ã„ã‚ã‚Šã¾ã™ãŒã€ãƒ†ã‚¹ãƒˆç”¨ã«5æ–‡
        }
      };

      // æ–°ã—ã„æ–‡ã‚’è§£æ”¾ã™ã‚‹é–¢æ•°ï¼ˆä¿®æ­£ç‰ˆï¼‰
      const unlockNextSentence = () => {
        setLiteraryProgress(prev => {
          console.log('=== æ–‡è§£æ”¾å‡¦ç†é–‹å§‹ ===');
          console.log('ç¾åœ¨ã®currentSentence:', prev.currentSentence);
          console.log('ç¾åœ¨ã®totalReadSentences:', prev.totalReadSentences);

          const currentWork = literaryWorks[prev.currentWork];
          const nextSentence = prev.currentSentence + 1;

          console.log('è¨ˆç®—ã•ã‚ŒãŸnextSentence:', nextSentence);
          console.log('ä½œå“ã®ç·æ–‡æ•°:', currentWork.sentences.length);

          // ã¾ã èª­ã‚ã‚‹æ–‡ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
          if (nextSentence < currentWork.sentences.length) {
            console.log(`æ–°ã—ã„æ–‡è§£æ”¾: ${nextSentence}æ–‡ç›®`);
            console.log('è§£æ”¾ã•ã‚ŒãŸæ–‡:', currentWork.sentences[nextSentence]);

            // ğŸ†• æ–°ã—ãè¿½åŠ ï¼šãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
            setNewlyUnlockedSentence(currentWork.sentences[nextSentence]);
            setShowNewSentenceDialog(true);

            const newState = {
              ...prev,
              currentSentence: nextSentence,
              totalReadSentences: prev.totalReadSentences + 1
            };

            console.log('æ–°ã—ã„çŠ¶æ…‹:', newState);
            console.log('=== æ–‡è§£æ”¾å‡¦ç†çµ‚äº† ===');
            return newState;
          } else {
            console.log('ã“ã®ä½œå“ã¯å…¨ã¦èª­ã¿çµ‚ã‚ã‚Šã¾ã—ãŸï¼');
            console.log('=== æ–‡è§£æ”¾å‡¦ç†çµ‚äº† ===');
            return prev;
          }
        });
      };

      // ãƒœã‚¹æƒ…å ±
      const bossData = [
        {
          id: 'fire_dragon',
          name: 'ç‚ã®ãƒ‰ãƒ©ã‚´ãƒ³',
          emoji: 'ğŸ‰',
          attribute: 'fire',
          hp: 100,
          attack: 80,
          description: 'ç‚ã‚’åãå¼·åŠ›ãªãƒ‰ãƒ©ã‚´ãƒ³'
        },
        {
          id: 'water_kraken',
          name: 'æ°´ã®ã‚¯ãƒ©ãƒ¼ã‚±ãƒ³',
          emoji: 'ğŸ™',
          attribute: 'water',
          hp: 120,
          attack: 75,
          description: 'æ·±æµ·ã‹ã‚‰ç¾ã‚ŒãŸå·¨å¤§ãªè§¦æ‰‹ã®é­”ç‰©'
        },
        {
          id: 'wood_treant',
          name: 'æ£®ã®ç•ªäºº',
          emoji: 'ğŸŒ³',
          attribute: 'wood',
          hp: 90,
          attack: 85,
          description: 'å¤ã„æ£®ã‚’å®ˆã‚‹å·¨å¤§ãªæ¨¹ã®ç²¾éœŠ'
        }
      ];

      // å±æ€§ç›¸æ€§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
      const attributeEffectiveness = {
        fire: { strongAgainst: 'wood', weakAgainst: 'water' },
        water: { strongAgainst: 'fire', weakAgainst: 'wood' },
        wood: { strongAgainst: 'water', weakAgainst: 'fire' }
      };

      // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å¾©å…ƒ
      useEffect(() => {
        loadData();
      }, []);

      // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
      const saveData = () => {
        const data = {
          reasonHistory,
          totalWorkTime,
          totalExp,
          level,
          fireFood,
          waterFood,
          woodFood,
          petLevel,
          playerEquipment
        };
        localStorage.setItem('pomodoroData', JSON.stringify(data));
      };

      // æ–‡å­¦ãƒ‡ãƒ¼ã‚¿å°‚ç”¨ã®ä¿å­˜é–¢æ•°
      const saveLiteraryData = () => {
        const literaryData = {
          literaryProgress
        };
        localStorage.setItem('pomodoroLiteraryData', JSON.stringify(literaryData));
      };

      // åˆ†é›¢ã•ã‚ŒãŸèª­ã¿è¾¼ã¿é–¢æ•°
      const loadData = () => {
        // ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        const gameData = localStorage.getItem('pomodoroData');
        if (gameData) {
          try {
            const data = JSON.parse(gameData);
            setReasonHistory(data.reasonHistory || []);
            setTotalWorkTime(data.totalWorkTime || 0);
            setTotalExp(data.totalExp || 0);
            setLevel(data.level || 1);
            setFireFood(data.fireFood || 0);
            setWaterFood(data.waterFood || 0);
            setWoodFood(data.woodFood || 0);
            setPetLevel(data.petLevel || 1);
            setPlayerEquipment(data.playerEquipment || 0);
          } catch (e) {
            console.log('ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
          }
        }

        // æ–‡å­¦ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        const literaryData = localStorage.getItem('pomodoroLiteraryData');
        if (literaryData) {
          try {
            const data = JSON.parse(literaryData);
            setLiteraryProgress(data.literaryProgress || {
              currentWork: 'hashire_melos',
              currentSentence: 0,
              completedWorks: [],
              totalReadSentences: 0
            });
          } catch (e) {
            console.log('æ–‡å­¦ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
          }
        }
      };

      useEffect(() => {
        saveData();
      }, [reasonHistory, totalWorkTime, totalExp, level, fireFood, waterFood, woodFood, petLevel, playerEquipment]
      );

      // æ–‡å­¦ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ä¿å­˜
      useEffect(() => {
        saveLiteraryData();
      }, [literaryProgress]);

      // å‘¼å¸ã‚¬ã‚¤ãƒ‰æ©Ÿèƒ½
      useEffect(() => {
        if (motivationMode === 'breathing') {
          breathingIntervalRef.current = setInterval(() => {
            setBreathingPhase(prev => {
              if (prev === 'inhale') return 'hold';
              if (prev === 'hold') return 'exhale';
              if (prev === 'exhale') {
                setBreathingCycle(cycle => {
                  const newCycle = cycle + 1;
                  if (newCycle >= 5) {
                    // 5ã‚µã‚¤ã‚¯ãƒ«å®Œäº†
                    setMotivationMode('choice');
                    return 0;
                  }
                  return newCycle;
                });
                return 'inhale';
              }
              return 'inhale';
            });
          }, breathingPhase === 'inhale' ? 4000 : breathingPhase === 'hold' ? 7000 : 8000);
        } else {
          if (breathingIntervalRef.current) {
            clearInterval(breathingIntervalRef.current);
          }
        }

        return () => {
          if (breathingIntervalRef.current) {
            clearInterval(breathingIntervalRef.current);
          }
        };
      }, [motivationMode, breathingPhase]);

      useEffect(() => {
        if (currentPhase === 'work') {
          console.log('ğŸ”¥ ä½œæ¥­ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹ï¼æ™‚é–“:', timeLeft, 'ç§’');
          intervalRef.current = setInterval(() => {
            setTimeLeft(prev => {
              console.log('â±ï¸ ã‚¿ã‚¤ãƒãƒ¼æ›´æ–°:', prev, 'â†’', prev - 1);
              if (prev <= 1) {
                setCurrentPhase('continue-check');
                setShowContinueDialog(true);
                setIsTimerFinished(true);
                return 0;
              }
              return prev - 1;
            });
          }, 1000);
        } else {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        }

        return () => {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        };
      }, [currentPhase]);

      // ä¼‘æ†©ã‚¿ã‚¤ãƒãƒ¼
      useEffect(() => {
        if (isBreakTime) {
          intervalRef.current = setInterval(() => {
            setBreakTimeLeft(prev => {
              console.log('ğŸ” ä¼‘æ†©ã‚¿ã‚¤ãƒãƒ¼:', prev, 'ç§’æ®‹ã‚Š');
              if (prev <= 1) {
                console.log('ğŸ¯ ä¼‘æ†©çµ‚äº†ï¼æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æº–å‚™é–‹å§‹');
                console.log('ğŸ“Š ç¾åœ¨ã®sessionCount:', sessionCount);
                console.log('ğŸ“‹ workDurationsé…åˆ—:', workDurations);
                console.log('ğŸ”¢ workDurations.length:', workDurations.length);

                setIsBreakTime(false);

                // ä¼‘æ†©çµ‚äº†å¾Œã€æ¬¡ã®ãƒ¯ãƒ¼ã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
                if (sessionCount < workDurations.length) {
                  const nextDuration = workDurations[sessionCount];
                  console.log('ğŸš€ çŠ¶æ…‹å¤‰æ›´å‰ - currentPhase:', currentPhase, 'timeLeft:', timeLeft);

                  // çŠ¶æ…‹ã‚’ç¢ºå®Ÿã«æ›´æ–°ã™ã‚‹ãŸã‚ã€ã¾ã¨ã‚ã¦å‡¦ç†
                  const newTimeLeft = nextDuration * 60;
                  console.log('ğŸš€ è¨­å®šäºˆå®š - nextDuration:', nextDuration, 'newTimeLeft:', newTimeLeft);

                  setCurrentWorkDuration(nextDuration);
                  setTimeLeft(newTimeLeft);
                  setCurrentPhase('work');
                  setWorkStartTime(Date.now());

                  // å¼·åˆ¶çš„ã«æ¬¡ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚µã‚¤ã‚¯ãƒ«ã§ç¢ºèª
                  setTimeout(() => {
                    console.log('ğŸ” nextTickå¾Œã®çŠ¶æ…‹ç¢ºèª');
                    // å¼·åˆ¶çš„ã«ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
                    if (intervalRef.current) {
                      clearInterval(intervalRef.current);
                    }
                    intervalRef.current = setInterval(() => {
                      setTimeLeft(prev => {
                        console.log('â±ï¸ å¼·åˆ¶ã‚¿ã‚¤ãƒãƒ¼æ›´æ–°:', prev, 'â†’', prev - 1);
                        if (prev <= 1) {
                          setCurrentPhase('continue-check');
                          setShowContinueDialog(true);
                          setIsTimerFinished(true);
                          return 0;
                        }
                        return prev - 1;
                      });
                    }, 1000);
                  }, 50);

                  // ä½œæ¥­é–‹å§‹æ™‚åˆ»ã‚’ã™ãã«è¨­å®š
                  setWorkStartTime(Date.now());
                } else {
                  console.log('ğŸ å…¨ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼');
                  setCurrentPhase('completed');
                }
                return 0;
              }
              return prev - 1;
            });
          }, 1000);
        } else {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        }

        return () => {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        };
      }, [isBreakTime, sessionCount]);

      const formatTime = (seconds) => {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      };

      const getRandomFood = () => {
        const foods = ['fire', 'water', 'wood'];
        return foods[Math.floor(Math.random() * 3)];
      };

      // æˆ¦é—˜ã‚·ã‚¹ãƒ†ãƒ é–¢æ•°
      const getFoodCount = (attribute) => {
        switch (attribute) {
          case 'fire': return fireFood;
          case 'water': return waterFood;
          case 'wood': return woodFood;
          default: return 0;
        }
      };

      const getEffectiveAttribute = (bossAttribute) => {
        switch (bossAttribute) {
          case 'fire': return 'water';    // ç«ã«ã¯æ°´ãŒæœ‰åŠ¹
          case 'water': return 'wood';    // æ°´ã«ã¯æœ¨ãŒæœ‰åŠ¹  
          case 'wood': return 'fire';     // æœ¨ã«ã¯ç«ãŒæœ‰åŠ¹
          default: return 'fire';
        }
      };

      const calculatePlayerPower = (boss) => {
        const effectiveAttribute = getEffectiveAttribute(boss.attribute);
        const effectiveFoodCount = getFoodCount(effectiveAttribute);

        return {
          hp: effectiveFoodCount,
          attack: Math.floor(effectiveFoodCount * 1.5), // æœ‰åˆ©å±æ€§ãƒœãƒ¼ãƒŠã‚¹
          defense: playerEquipment,
          effectiveAttribute,
          effectiveFoodCount
        };
      };

      const simulateBattle = (playerPower, boss) => {
        // æ•µã®æ”»æ’ƒã§ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå—ã‘ã‚‹ãƒ€ãƒ¡ãƒ¼ã‚¸
        const damageReceived = Math.max(0, boss.attack - playerPower.defense);
        const playerSurvives = playerPower.hp > damageReceived;

        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ•µã‚’ä¸€æ’ƒã§å€’ã›ã‚‹ã‹
        const canDefeatBoss = playerPower.attack >= boss.hp;

        return {
          victory: playerSurvives && canDefeatBoss,
          damageReceived,
          playerSurvives,
          canDefeatBoss,
          playerPower,
          boss
        };
      };

      const rollEquipmentGacha = (foodCost = 1) => {
        const baseDefense = Math.floor(Math.random() * 11) + 5; // 5-15
        const equipmentNames = ['é‹¼ã®ç›¾', 'é­”æ³•ã®é§', 'ç«œé±—ã®ç›¾', 'è–ãªã‚‹å¤–å¥—', 'å¤ã®å®ˆè­·å…·'];
        const randomName = equipmentNames[Math.floor(Math.random() * equipmentNames.length)];

        return {
          name: `${randomName} +${baseDefense}`,
          defense: baseDefense,
          cost: foodCost
        };
      };
      const executeEquipmentGacha = () => {
        // ç¾åœ¨ã®ãƒœã‚¹æˆ¦ã§æœ‰åŠ¹ã§ãªã„å±æ€§ã®ã‚¨ã‚µã‚’ç‰¹å®š
        // ãƒœã‚¹ãŒã„ãªã„å ´åˆã¯ã€ã©ã®ã‚¨ã‚µã§ã‚‚æ¶ˆè²»å¯èƒ½
        let availableFoodTypes = [];

        if (currentBoss) {
          const effectiveAttribute = getEffectiveAttribute(currentBoss.attribute);
          // æœ‰åŠ¹å±æ€§ä»¥å¤–ã®ã‚¨ã‚µã‚’å¯¾è±¡ã«ã™ã‚‹
          if (effectiveAttribute !== 'fire' && fireFood > 0) availableFoodTypes.push('fire');
          if (effectiveAttribute !== 'water' && waterFood > 0) availableFoodTypes.push('water');
          if (effectiveAttribute !== 'wood' && woodFood > 0) availableFoodTypes.push('wood');
        } else {
          // ãƒœã‚¹ãŒã„ãªã„å ´åˆã¯å…¨ã¦ã®ã‚¨ã‚µãŒä½¿ç”¨å¯èƒ½
          if (fireFood > 0) availableFoodTypes.push('fire');
          if (waterFood > 0) availableFoodTypes.push('water');
          if (woodFood > 0) availableFoodTypes.push('wood');
        }

        if (availableFoodTypes.length === 0) return; // ä½¿ç”¨å¯èƒ½ãªã‚¨ã‚µãŒãªã„

        // ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤é¸æŠï¼ˆè¤‡æ•°ã‚ã‚‹å ´åˆï¼‰
        const selectedFoodType = availableFoodTypes[Math.floor(Math.random() * availableFoodTypes.length)];

        // ã‚¨ã‚µã‚’1å€‹æ¶ˆè²»
        if (selectedFoodType === 'fire') setFireFood(prev => prev - 1);
        if (selectedFoodType === 'water') setWaterFood(prev => prev - 1);
        if (selectedFoodType === 'wood') setWoodFood(prev => prev - 1);

        // ã‚¬ãƒãƒ£å®Ÿè¡Œ
        const result = rollEquipmentGacha(1);
        result.usedFoodType = selectedFoodType;
        setGachaResult(result);
      };

      const spawnRandomBoss = () => {
        const randomBoss = bossData[Math.floor(Math.random() * bossData.length)];
        setCurrentBoss({ ...randomBoss });
        setBattlePhase('preview');
      };

      const startWork = () => {
        setShowReasonDialog(true);
        setCurrentPhase('work');
        setTimeLeft(currentWorkDuration * 60);
        setWorkStartTime(Date.now());
      };

      const startBreathing = () => {
        setMotivationMode('breathing');
        setBreathingCycle(0);
        setBreathingPhase('inhale');
      };

      const handlePassiveTaskSubmit = () => {
        if (passiveTask.trim()) {
          setShowPassiveTaskSubmit(true);
        }
      };

      const handlePassiveTaskStart = () => {
        setMotivationMode('normal');
        setCurrentWorkDuration(5);
        setShowPassiveTaskSubmit(false);
        setReason(passiveTask);
        setPassiveTask('');
        startWork();
      };

      const handleWalkSuggestion = () => {
        setMotivationMode('walk-suggestion');
        setShowPassiveTaskSubmit(false);
      };

      const handleReturnFromWalk = () => {
        setMotivationMode('task-input');
      };

      const handleWorkoutSuggestion = () => {
        setMotivationMode('workout-suggestion');
        setShowPassiveTaskSubmit(false);
      };

      const handleReturnFromWorkout = () => {
        setMotivationMode('task-input');
      };

      const resetMotivationMode = () => {
        setMotivationMode('normal');
        setBreathingCycle(0);
        setBreathingPhase('inhale');
        setPassiveTask('');
        setShowPassiveTaskSubmit(false);
      };

      const getBreathingCircleSize = () => {
        if (breathingPhase === 'inhale') return 'w-32 h-32 scale-110';
        if (breathingPhase === 'hold') return 'w-32 h-32 scale-110';
        if (breathingPhase === 'exhale') return 'w-20 h-20 scale-90';
        return 'w-24 h-24';
      };

      const getBreathingText = () => {
        if (breathingPhase === 'inhale') return 'æ¯ã‚’å¸ã£ã¦';
        if (breathingPhase === 'hold') return 'æ­¢ã‚ã¦';
        if (breathingPhase === 'exhale') return 'æ¯ã‚’åã„ã¦';
        return '';
      };

      const handleReasonSubmit = () => {
        if (reason.trim()) {
          setCurrentTaskReason(reason.trim());
          setReason('');
        }
        setShowReasonDialog(false);
      };


      const handleTaskComplete = () => {
        const actualWorkTime = Math.ceil((Date.now() - workStartTime) / 60000);
        const expGained = Math.ceil(actualWorkTime * 1.5);

        const now = new Date();
        setReasonHistory(prev => [...prev, {
          reason: currentTaskReason,
          result: taskResult.trim() || 'ä½œæ¥­å®Œäº†',
          datetime: now.toLocaleString('ja-JP'),
          plannedDuration: currentWorkDuration,
          actualDuration: actualWorkTime,
          expGained
        }]);

        setTotalWorkTime(prev => prev + actualWorkTime);
        setTotalExp(prev => {
          const newExp = prev + expGained;
          const newLevel = Math.floor(newExp / 100) + 1;
          setLevel(newLevel);
          return newExp;
          // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ï¼šæ–°ã—ã„æ–‡ã‚’è§£æ”¾
          unlockNextSentence();
        });
        // ã‚¨ã‚µç²å¾—å‡¦ç†
        const foodType = getRandomFood();
        if (foodType === 'fire') setFireFood(prev => prev + 1);
        if (foodType === 'water') setWaterFood(prev => prev + 1);
        if (foodType === 'wood') setWoodFood(prev => prev + 1);
        // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ï¼šæ–°ã—ã„æ–‡ã‚’è§£æ”¾
        unlockNextSentence();

        // çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        setShowTaskCompleteDialog(false);
        setCurrentPhase('idle');
        setCurrentTaskReason('');
        setTaskResult('');
        setSessionCount(0);
        setCurrentWorkDuration(5);
        setTimeLeft(0);
        setWorkStartTime(null);
        setIsTimerFinished(false);
      };

      const handleEarlyComplete = () => {
        if (intervalRef.current) {
          clearInterval(intervalRef.current);
        }
        // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ï¼šæ–°ã—ã„æ–‡ã‚’è§£æ”¾
        unlockNextSentence();
        setCurrentPhase('task-complete');
        setShowTaskCompleteDialog(true);
      };
      const handleContinue = () => {
        console.log('=== ç¶šã‘ã‚‹ãƒœã‚¿ãƒ³å‡¦ç†é–‹å§‹ ===');

        setShowContinueDialog(false);
        setIsTimerFinished(false);
        setSessionCount(prev => prev + 1);

        // ã‚¨ã‚µç²å¾—å‡¦ç†
        const foodType = getRandomFood();
        if (foodType === 'fire') setFireFood(prev => prev + 1);
        if (foodType === 'water') setWaterFood(prev => prev + 1);
        if (foodType === 'wood') setWoodFood(prev => prev + 1);

        // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ï¼šæ–°ã—ã„æ–‡ã‚’è§£æ”¾
        unlockNextSentence();

        const currentActualTime = Math.ceil((Date.now() - workStartTime) / 60000);
        if (currentActualTime >= 56) {
          setCurrentPhase('completed');
          return;
        }

        const nextSessionIndex = sessionCount + 1;

        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¿½åŠ 
        console.log('ç¾åœ¨ã®sessionCount:', sessionCount);
        console.log('nextSessionIndex:', nextSessionIndex);
        console.log('workDurations.length:', workDurations.length);
        console.log('æ¡ä»¶ãƒã‚§ãƒƒã‚¯:', nextSessionIndex < workDurations.length);

        if (nextSessionIndex < workDurations.length) {
          console.log('âœ… æ¡ä»¶OKã€æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹');
          setCurrentWorkDuration(workDurations[nextSessionIndex]);
          setCurrentPhase('work');
          setTimeLeft(workDurations[nextSessionIndex] * 60);
          setWorkStartTime(Date.now());
          console.log('æ¬¡ã®ä½œæ¥­æ™‚é–“:', workDurations[nextSessionIndex], 'åˆ†');

          // è¿½åŠ ï¼šå¼·åˆ¶çš„ã«ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹ï¼ˆä¼‘æ†©çµ‚äº†æ™‚ã¨åŒã˜å‡¦ç†ï¼‰
          setTimeout(() => {
            console.log('ğŸ”§ å¼·åˆ¶ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹å‡¦ç†');
            if (intervalRef.current) {
              clearInterval(intervalRef.current);
            }
            intervalRef.current = setInterval(() => {
              setTimeLeft(prev => {
                console.log('â±ï¸ å¼·åˆ¶ã‚¿ã‚¤ãƒãƒ¼æ›´æ–°:', prev, 'â†’', prev - 1);
                if (prev <= 1) {
                  setCurrentPhase('continue-check');
                  setShowContinueDialog(true);
                  setIsTimerFinished(true);
                  return 0;
                }
                return prev - 1;
              });
            }, 1000);
          }, 50);

        } else {
          console.log('âŒ å…¨ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ã€æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãªã—');
        }
      };

      const handleStop = () => {
        setShowContinueDialog(false);
        setIsTimerFinished(false);

        if (sessionCount === 0) {
          setShowBreakSuggestion(true);
        } else {
          setShowTaskCompleteDialog(true);
        }
      };

      const handleBreakSuggestion = (action) => {
        setShowBreakSuggestion(false);
        if (action === 'retry') {
          setCurrentPhase('work');
          setTimeLeft(5 * 60);
        } else {
          setCurrentPhase('idle');
        }
      };

      const reset = () => {
        setCurrentPhase('idle');
        setTimeLeft(0);
        setCurrentWorkDuration(5);
        setSessionCount(0);
        setTotalWorkTime(0);
        setReasonHistory([]);
        setShowReasonDialog(false);
        setShowContinueDialog(false);
        setShowBreakSuggestion(false);
        setShowTaskCompleteDialog(false);
        setCurrentTaskReason('');
        setTaskResult('');
        setIsTimerFinished(false);
        setWorkStartTime(null);
        saveData();
      };

      const getPhaseDisplay = () => {
        if (isBreakTime) {
          return 'ä¼‘æ†©ä¸­ (5åˆ†)';
        }

        switch (currentPhase) {
          case 'work':
            return `ä½œæ¥­ä¸­ (${currentWorkDuration}åˆ†)`;
          case 'continue-check':
            return 'ç¶™ç¶šç¢ºèª';
          case 'completed':
            return 'ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼';
          default:
            return 'å¾…æ©Ÿä¸­';
        }
      };

      return React.createElement('div', {
        className: `min-h-screen bg-gray-50 py-8 px-4`
      },
        React.createElement('div', {
          className: `max-w-md mx-auto p-6 rounded-lg shadow-lg transition-all duration-500 ${isTimerFinished ? 'bg-green-100 border-4 border-green-400 animate-pulse' : 'bg-white'
            }`
        },
          React.createElement('h1', {
            className: 'text-2xl font-bold text-gray-800 mb-6 text-center'
          }, 'é©å¿œå‹ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼'),

          React.createElement('div', {
            className: 'text-center mb-6'
          },
            React.createElement('div', {
              className: 'text-lg font-medium text-gray-600 mb-2'
            }, getPhaseDisplay()),
            React.createElement('div', {
              className: 'text-4xl font-mono font-bold text-gray-800'
            }, formatTime(isBreakTime ? breakTimeLeft : timeLeft)),

            currentTaskReason && currentPhase === 'work' && React.createElement('div', {
              className: 'mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg'
            },
              React.createElement('div', {
                className: 'text-sm text-gray-600 mb-1'
              }, 'ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯:'),
              React.createElement('div', {
                className: 'text-sm font-medium text-gray-800'
              }, currentTaskReason)
            )
          ),

          // ãƒ¬ãƒ™ãƒ«ã¨çµŒé¨“å€¤è¡¨ç¤º
          React.createElement('div', {
            className: 'mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg'
          },
            React.createElement('div', {
              className: 'flex justify-between items-center mb-2'
            },
              React.createElement('span', {
                className: 'text-sm font-medium text-blue-800'
              }, `Lv.${level}`),
              React.createElement('span', {
                className: 'text-sm text-blue-600'
              }, `${totalExp % 100}/100 EXP`)
            ),
            React.createElement('div', {
              className: 'w-full bg-blue-200 rounded-full h-2'
            },
              React.createElement('div', {
                className: 'bg-blue-600 h-2 rounded-full transition-all duration-300',
                style: { width: `${(totalExp % 100)}%` }
              })
            ),
            React.createElement('div', {
              className: 'text-xs text-blue-600 mt-1'
            }, `ç´¯è¨ˆä½œæ¥­æ™‚é–“: ${totalWorkTime}åˆ† | ç·çµŒé¨“å€¤: ${totalExp}`)
          ),

          // ãƒšãƒƒãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢
          React.createElement('div', {
            className: 'mb-4 p-3 bg-green-50 border border-green-200 rounded-lg'
          },
            React.createElement('div', {
              className: 'text-center mb-2'
            },
              React.createElement('div', {
                className: 'text-4xl mb-1'
              }, petType === 'egg' ? 'ğŸ¥š' : petType === 'cat' ? 'ğŸ±' : 'ğŸ‰'),
              React.createElement('div', {
                className: 'text-sm font-medium text-green-800'
              }, `ãƒšãƒƒãƒˆLv.${petLevel}`)
            ),
            React.createElement('div', {
              className: 'text-xs text-green-600 text-center'
            }, `ğŸ”¥${fireFood} ğŸ’§${waterFood} ğŸŒ¿${woodFood}`)
          ),

          React.createElement('div', {
            className: 'mb-6'
          },
            React.createElement('div', {
              className: 'text-sm text-gray-600 mb-2'
            }, `ã‚»ãƒƒã‚·ãƒ§ãƒ³: ${sessionCount + 1}/6`),
            React.createElement('div', {
              className: 'w-full bg-gray-200 rounded-full h-2'
            },
              React.createElement('div', {
                className: 'bg-green-600 h-2 rounded-full transition-all duration-300',
                style: { width: `${((sessionCount + 1) / 6) * 100}%` }
              })
            )
          ),

          React.createElement('div', {
            className: 'space-y-4'
          },
            currentPhase === 'work' && React.createElement('button', {
              onClick: handleEarlyComplete,
              className: 'w-full py-3 px-4 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 transition-colors mb-4'
            }, 'ã‚¿ã‚¹ã‚¯çµ‚äº†'),

            currentPhase === 'idle' && motivationMode === 'normal' && React.createElement('div', {
              className: 'space-y-6'
            },
              // ğŸ”§ ãƒ‡ãƒãƒƒã‚°ãƒœã‚¿ãƒ³é ˜åŸŸ
              React.createElement('div', {
                className: 'space-y-2'
              },
                React.createElement('div', {
                  className: 'text-xs text-gray-500 font-medium mb-2 text-center border-b border-gray-200 pb-1'
                }, 'ğŸ”§ ãƒ‡ãƒãƒƒã‚°'),

                React.createElement('button', {
                  onClick: () => {
                    if (isBreakTime) {
                      setBreakTimeLeft(1);
                    } else {
                      setTimeLeft(1);
                    }
                  },
                  className: 'w-full py-2 px-4 bg-yellow-500 text-white rounded-lg font-medium hover:bg-yellow-600 transition-colors text-sm'
                }, 'âš¡ ã‚¿ã‚¤ãƒãƒ¼ã‚¹ã‚­ãƒƒãƒ—'),

                React.createElement('button', {
                  onClick: () => {
                    if (confirm('ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¬ãƒ™ãƒ«ãƒ»ã‚¨ã‚µãƒ»è£…å‚™ç­‰ï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                      localStorage.removeItem('pomodoroData');
                      setReasonHistory([]);
                      setTotalWorkTime(0);
                      setTotalExp(0);
                      setLevel(1);
                      setFireFood(0);
                      setWaterFood(0);
                      setWoodFood(0);
                      setPetLevel(1);
                      setPlayerEquipment(0);
                    }
                  },
                  className: 'w-full py-2 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm'
                }, 'ğŸ® ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å‰Šé™¤')
              ),

              // ğŸ¯ ã‚¿ã‚¤ãƒãƒ¼ãƒœã‚¿ãƒ³é ˜åŸŸ
              React.createElement('div', {
                className: 'space-y-2'
              },
                React.createElement('div', {
                  className: 'text-xs text-gray-500 font-medium mb-2 text-center border-b border-gray-200 pb-1'
                }, 'ğŸ¯ ä½œæ¥­é–‹å§‹'),

                React.createElement('button', {
                  onClick: startWork,
                  className: 'w-full py-3 px-4 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition-colors'
                }, 'å«Œã ãªãƒœã‚¿ãƒ³'),

                React.createElement('button', {
                  onClick: startBreathing,
                  className: 'w-full py-3 px-4 bg-gray-400 text-white rounded-lg font-medium hover:bg-gray-500 transition-colors'
                }, 'ä½•ã®ã‚„ã‚‹æ°—ã‚‚å‡ºãªã„')
              ),

              // ğŸ® ã‚²ãƒ¼ãƒ ãƒœã‚¿ãƒ³é ˜åŸŸ
              React.createElement('div', {
                className: 'space-y-2'
              },
                React.createElement('div', {
                  className: 'text-xs text-gray-500 font-medium mb-2 text-center border-b border-gray-200 pb-1'
                }, 'ğŸ® ã‚²ãƒ¼ãƒ '),

                React.createElement('button', {
                  onClick: spawnRandomBoss,
                  className: 'w-full py-3 px-4 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors'
                }, 'âš”ï¸ ãƒœã‚¹æˆ¦ã«æŒ‘æˆ¦'),

                React.createElement('button', {
                  onClick: () => {
                    executeEquipmentGacha();
                    setShowEquipmentGacha(true);
                  },
                  disabled: (() => {
                    if (currentBoss) {
                      const effectiveAttribute = getEffectiveAttribute(currentBoss.attribute);
                      return (effectiveAttribute !== 'fire' ? fireFood : 0) +
                        (effectiveAttribute !== 'water' ? waterFood : 0) +
                        (effectiveAttribute !== 'wood' ? woodFood : 0) === 0;
                    } else {
                      return fireFood === 0 && waterFood === 0 && woodFood === 0;
                    }
                  })(),
                  className: `w-full py-3 px-4 ${(() => {
                    if (currentBoss) {
                      const effectiveAttribute = getEffectiveAttribute(currentBoss.attribute);
                      const hasUsableFood = (effectiveAttribute !== 'fire' ? fireFood : 0) +
                        (effectiveAttribute !== 'water' ? waterFood : 0) +
                        (effectiveAttribute !== 'wood' ? woodFood : 0) > 0;
                      return hasUsableFood ? 'bg-orange-500 hover:bg-orange-600' : 'bg-gray-300';
                    } else {
                      return (fireFood > 0 || waterFood > 0 || woodFood > 0) ? 'bg-orange-500 hover:bg-orange-600' : 'bg-gray-300';
                    }
                  })()} text-white rounded-lg font-medium transition-colors`
                }, `ğŸ° è£…å‚™ã‚¬ãƒãƒ£ (ã‚¨ã‚µ1å€‹æ¶ˆè²»)`),

                React.createElement('button', {
                  onClick: () => setShowReadingHistory(true),
                  className: 'w-full py-3 px-4 bg-indigo-500 text-white rounded-lg font-medium hover:bg-indigo-600 transition-colors'
                }, 'ğŸ“š èª­æ›¸è¨˜éŒ²')
              )
            ),


            // ãƒœã‚¹äºˆå‘Šç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(BattlePreviewDialog, {
              show: battlePhase === 'preview',
              boss: currentBoss,
              playerFood: { fire: fireFood, water: waterFood, wood: woodFood },
              playerEquipment: playerEquipment,
              onProceed: () => setBattlePhase('preparation'),
              onEscape: () => setBattlePhase('none')
            }),

            // æˆ¦é—˜æº–å‚™ç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(BattlePreparationDialog, {
              show: battlePhase === 'preparation',
              boss: currentBoss,
              playerFood: { fire: fireFood, water: waterFood, wood: woodFood },
              playerEquipment: playerEquipment,
              onBattle: (battleSim) => {
                setBattleResult(battleSim);
                setBattlePhase('result');
              },
              onBack: () => setBattlePhase('preview')
            }),

            // æˆ¦é—˜çµæœç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(BattleResultDialog, {
              show: battlePhase === 'result',
              battleResult: battleResult,
              bossName: currentBoss?.name || '',
              onClose: () => {
                setBattlePhase('none');
                setCurrentBoss(null);
                setBattleResult(null);
              }
            }),

            // è£…å‚™ã‚¬ãƒãƒ£çµæœç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(EquipmentGachaDialog, {
              show: showEquipmentGacha,
              gachaResult: gachaResult,
              currentEquipment: playerEquipment,
              onEquip: () => {
                setPlayerEquipment(gachaResult.defense);
                setShowEquipmentGacha(false);
                setGachaResult(null);
              },
              onKeepCurrent: () => {
                setPlayerEquipment(gachaResult.defense);
                setShowEquipmentGacha(false);
                setGachaResult(null);
              },
              onDiscard: () => {
                setShowEquipmentGacha(false);
                setGachaResult(null);
              }
            }),

            // æ–°ã—ã„æ–‡è§£æ”¾ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(NewSentenceDialog, {
              show: showNewSentenceDialog,
              sentence: newlyUnlockedSentence,
              onClose: () => {
                setShowNewSentenceDialog(false);
                setNewlyUnlockedSentence('');
              }
            }),

            // èª­æ›¸è¨˜éŒ²ç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(ReadingHistoryDialog, {
              show: showReadingHistory,
              literaryProgress: literaryProgress,
              literaryWorks: literaryWorks,
              onClose: () => setShowReadingHistory(false),
              onSelectWork: (work) => setSelectedWork(work),
              onDeleteData: () => {
                if (confirm('èª­æ›¸ãƒ‡ãƒ¼ã‚¿ï¼ˆæ–‡å­¦é€²æ—ï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                  localStorage.removeItem('pomodoroLiteraryData');
                  setLiteraryProgress({
                    currentWork: 'hashire_melos',
                    currentSentence: 0,
                    completedWorks: [],
                    totalReadSentences: 0
                  });
                  setShowReadingHistory(false);
                }
              }
            }),

            // ä½œå“èª­æ›¸ç”»é¢ï¼ˆç½®ãæ›ãˆå¾Œï¼‰
            React.createElement(WorkReadingDialog, {
              show: !!selectedWork,
              selectedWork: selectedWork,
              literaryWorks: literaryWorks,
              literaryProgress: literaryProgress,
              onBack: () => setSelectedWork(null),
              onClose: () => {
                setSelectedWork(null);
                setShowReadingHistory(false);
              }
            }),

            currentPhase === 'completed' && React.createElement('div', {
              className: 'text-center'
            },
              React.createElement('p', {
                className: 'text-green-600 font-medium mb-4'
              }, 'ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼ç´„1æ™‚é–“ã®ä½œæ¥­ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚'),
              React.createElement('button', {
                onClick: reset,
                className: 'py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors'
              }, 'ãƒªã‚»ãƒƒãƒˆ')
            ),

            reasonHistory.length > 0 && React.createElement('div', {
              className: 'mt-6'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium text-gray-800 mb-3'
              }, 'è¨˜éŒ²'),
              React.createElement('div', {
                className: 'space-y-2 max-h-40 overflow-y-auto'
              },
                reasonHistory.map((entry, index) =>
                  React.createElement('div', {
                    key: index,
                    className: 'p-3 bg-gray-50 rounded text-sm border-l-4 border-blue-400'
                  },
                    React.createElement('div', {
                      className: 'font-medium text-gray-800 mb-1'
                    }, entry.datetime),
                    React.createElement('div', {
                      className: 'text-gray-600 mb-1'
                    },
                      React.createElement('span', {
                        className: 'font-medium'
                      }, 'èª²é¡Œ: '),
                      entry.reason
                    ),
                    React.createElement('div', {
                      className: 'text-gray-600 mb-1'
                    },
                      React.createElement('span', {
                        className: 'font-medium'
                      }, 'çµæœ: '),
                      entry.result
                    ),
                    React.createElement('div', {
                      className: 'flex justify-between text-xs text-gray-500'
                    },
                      React.createElement('span', {}, `äºˆå®š: ${entry.plannedDuration}åˆ† / å®Ÿéš›: ${entry.actualDuration}åˆ†`),
                      React.createElement('span', {
                        className: 'text-blue-600 font-medium'
                      }, `+${entry.expGained} EXP`)
                    )
                  )
                )
              )
            )
          ),

          // ç†ç”±å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          showReasonDialog && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'ä½•ãŒå«Œã§ã—ãŸã‹ï¼Ÿ'),
              React.createElement('textarea', {
                value: reason,
                onChange: (e) => setReason(e.target.value),
                className: 'w-full p-3 border border-gray-300 rounded-lg mb-4 resize-none',
                rows: 3,
                placeholder: 'ä¾‹ï¼šãƒ¬ãƒãƒ¼ãƒˆã‚’æ›¸ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„...'
              }),
              React.createElement('div', {
                className: 'flex space-x-2'
              },
                React.createElement('button', {
                  onClick: handleReasonSubmit,
                  className: 'flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors'
                }, 'é–‹å§‹')
              ),
              React.createElement('div', {
                className: 'mt-2 text-xs text-gray-500 text-center'
              }, `ã‚¿ã‚¤ãƒãƒ¼ã¯æ—¢ã«é–‹å§‹ã•ã‚Œã¦ã„ã¾ã™ (${currentWorkDuration}åˆ†)`)
            )
          ),

          // ç¶™ç¶šç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          showContinueDialog && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full text-center'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, `${currentWorkDuration}åˆ†ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼`),
              React.createElement('div', {
                className: 'mb-6'
              },
                React.createElement('p', {
                  className: 'text-sm text-gray-600 mb-2'
                }, `æ¬¡ã¯${sessionCount + 1 < workDurations.length ? workDurations[sessionCount + 1] : 15}åˆ†ã®ä½œæ¥­ã«ãªã‚Šã¾ã™`),
                React.createElement('p', {
                  className: 'text-sm text-gray-600'
                }, 'ç¶šã‘ã‚‰ã‚Œãã†ã§ã™ã‹ï¼Ÿï¼ˆä¼‘æ†©ãªã—ã§å³åº§ã«é–‹å§‹ï¼‰')
              ),
              React.createElement('div', {
                className: 'flex space-x-2'
              },
                React.createElement('button', {
                  onClick: handleContinue,
                  className: 'flex-1 py-2 px-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors'
                }, 'ç¶šã‘ã‚‹'),
                React.createElement('button', {
                  onClick: () => {
                    setShowContinueDialog(false);
                    setIsTimerFinished(false);
                    setSessionCount(prev => prev + 1);
                    // ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†ã§ã‚¨ã‚µç²å¾—
                    const foodType = getRandomFood();
                    if (foodType === 'fire') setFireFood(prev => prev + 1);
                    if (foodType === 'water') setWaterFood(prev => prev + 1);
                    if (foodType === 'wood') setWoodFood(prev => prev + 1);
                    // æ–‡å­¦ã‚·ã‚¹ãƒ†ãƒ ï¼šæ–°ã—ã„æ–‡ã‚’è§£æ”¾
                    unlockNextSentence();
                    setIsBreakTime(true);
                    setBreakTimeLeft(5 * 60); // 5åˆ†ä¼‘æ†©
                  },

                  className: 'flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors'
                }, '5åˆ†ä¼‘æ†©'),
                React.createElement('button', {
                  onClick: handleStop,
                  className: 'flex-1 py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors'
                }, 'çµ‚äº†')
              )
            )
          ),

          // ã‚¿ã‚¹ã‚¯åˆ†è§£ææ¡ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          showBreakSuggestion && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'ã‚¿ã‚¹ã‚¯ã‚’åˆ†è§£ã—ã¦ã¿ã¾ã—ã‚‡ã†'),
              React.createElement('div', {
                className: 'text-sm text-gray-600 mb-4'
              },
                React.createElement('p', {
                  className: 'mb-2'
                }, '5åˆ†ã‚‚é›†ä¸­ã§ããªã‹ã£ãŸå ´åˆã¯ã€ã‚¿ã‚¹ã‚¯ã‚’ã‚ˆã‚Šå°ã•ãåˆ†ã‘ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š'),
                React.createElement('ul', {
                  className: 'list-disc list-inside space-y-1'
                },
                  React.createElement('li', {}, 'è³‡æ–™ã‚’1ãƒšãƒ¼ã‚¸ã ã‘èª­ã‚€'),
                  React.createElement('li', {}, 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã‚¿ã‚¤ãƒˆãƒ«ã ã‘æ›¸ã'),
                  React.createElement('li', {}, 'é–¢é€£ã™ã‚‹é“å…·ã‚„è³‡æ–™ã‚’æœºã«ä¸¦ã¹ã‚‹'),
                  React.createElement('li', {}, '5è¡Œã ã‘ãƒ¡ãƒ¢ã‚’æ›¸ã'),
                  React.createElement('li', {}, '1ã¤ã®æ®µè½ã ã‘èª­ã‚€')
                )
              ),
              React.createElement('div', {
                className: 'flex space-x-2'
              },
                React.createElement('button', {
                  onClick: () => handleBreakSuggestion('retry'),
                  className: 'flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm'
                }, 'ã‚‚ã†ä¸€åº¦5åˆ†'),
                React.createElement('button', {
                  onClick: () => handleBreakSuggestion('stop'),
                  className: 'flex-1 py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm'
                }, 'ä»Šæ—¥ã¯çµ‚äº†')
              )
            )
          ),
          // å‘¼å¸ã‚¬ã‚¤ãƒ‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          motivationMode === 'breathing' && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full text-center'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'æ·±å‘¼å¸ã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†'),

              React.createElement('div', {
                className: 'flex justify-center mb-6'
              },
                React.createElement('div', {
                  className: `rounded-full bg-blue-300 transition-all duration-1000 ${getBreathingCircleSize()}`
                })
              ),

              React.createElement('div', {
                className: 'text-xl font-medium text-blue-600 mb-4'
              }, getBreathingText()),

              React.createElement('div', {
                className: 'text-sm text-gray-600 mb-4'
              }, `${breathingCycle + 1}/5 å›ç›®`),

              
              React.createElement('div', {
                className: 'space-y-2'
              },
                React.createElement('button', {
                  onClick: () => setBreathingCycle(4),
                  className: 'w-full py-2 px-4 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm'
                }, 'ğŸ« ã‚¹ã‚­ãƒƒãƒ—'),

                React.createElement('button', {
                  onClick: resetMotivationMode,
                  className: 'w-full py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors'
                }, 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«')
              )
            )
          ),

          // ã‚¿ã‚¹ã‚¯å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          motivationMode === 'task-input' && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'å°ã•ãªã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),

              React.createElement('textarea', {
                value: passiveTask,
                onChange: (e) => setPassiveTask(e.target.value),
                className: 'w-full p-3 border border-gray-300 rounded-lg resize-none',
                rows: 3,
                placeholder: 'ä¾‹ï¼šæœºã®ä¸Šã‚’æ•´ç†ã™ã‚‹ã€ãƒ¡ãƒ¼ãƒ«ã‚’1é€šè¿”ä¿¡ã™ã‚‹...'
              }),

              React.createElement('div', {
                className: 'space-y-2 mt-4'
              },
                React.createElement('button', {
                  onClick: handlePassiveTaskSubmit,
                  disabled: !passiveTask.trim(),
                  className: `w-full py-3 px-4 ${passiveTask.trim() ? 'bg-blue-500 hover:bg-blue-600' : 'bg-gray-300'} text-white rounded-lg font-medium transition-colors`
                }, '5åˆ†ã ã‘ã‚„ã£ã¦ã¿ã‚‹'),

                React.createElement('button', {
                  onClick: resetMotivationMode,
                  className: 'w-full py-2 px-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors'
                }, 'æˆ»ã‚‹')
              )
            )
          ),
          // é¸æŠè‚¢ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆæ·±å‘¼å¸å®Œäº†å¾Œï¼‰
          motivationMode === 'choice' && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full text-center'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-6'
              }, 'ã©ã†ã—ã¾ã™ã‹ï¼Ÿ'),

              React.createElement('div', {
                className: 'space-y-3'
              },
                React.createElement('button', {
                  onClick: () => setShowReasonDialog(true),
                  className: 'w-full py-3 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors'
                }, '5åˆ†ã ã‘ã‚„ã£ã¦ã¿ã‚‹'),

                React.createElement('button', {
                  onClick: () => setMotivationMode('workout'),
                  className: 'w-full py-3 px-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors'
                }, 'ç­‹ãƒˆãƒ¬ã™ã‚‹'),

                React.createElement('button', {
                  onClick: () => setMotivationMode('walk'),
                  className: 'w-full py-3 px-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors'
                }, 'æ•£æ­©ã™ã‚‹')
              )
            )
          ),

          // ç­‹ãƒˆãƒ¬ç”»é¢
          motivationMode === 'workout' && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full text-center'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'ğŸ’ª HIITã‚¿ã‚¤ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ãã ã•ã„'),

              React.createElement('div', {
                className: 'mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg'
              },
                React.createElement('p', {
                  className: 'text-sm text-gray-700'
                }, 'åˆ¥ã®ã‚¢ãƒ—ãƒªã§HIITã‚¿ã‚¤ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ã€ç­‹ãƒˆãƒ¬ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚å®Œäº†ã—ãŸã‚‰ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚')
              ),

              React.createElement('button', {
                onClick: () => {
                  setMotivationMode('normal');  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹
                  setShowReasonDialog(true);    // ã‚¿ã‚¹ã‚¯å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
                },
                className: 'w-full py-3 px-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors'
              }, 'ç­‹ãƒˆãƒ¬å®Œäº†')
            )
          ),

          // æ•£æ­©ç”»é¢
          motivationMode === 'walk' && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full text-center'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'ğŸš¶â€â™‚ï¸ 10åˆ†ç¨‹åº¦ã®æ•£æ­©ã‚’ã—ã¦ãã¦ãã ã•ã„'),

              React.createElement('div', {
                className: 'mb-6 p-4 bg-green-50 border border-green-200 rounded-lg'
              },
                React.createElement('p', {
                  className: 'text-sm text-gray-700'
                }, 'å¤–ã®ç©ºæ°—ã‚’å¸ã£ã¦ã€è»½ãæ­©ã„ã¦ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã¦ãã¦ãã ã•ã„ã€‚æˆ»ã£ãŸã‚‰ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚')
              ),

              React.createElement('button', {
                onClick: () => {
                  setMotivationMode('normal');  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹
                  setShowReasonDialog(true);    // ã‚¿ã‚¹ã‚¯å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
                },
                className: 'w-full py-3 px-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors'
              }, 'æ•£æ­©å®Œäº†')
            )
          ),

          // ã‚¿ã‚¹ã‚¯å®Œäº†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
          showTaskCompleteDialog && React.createElement('div', {
            className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50'
          },
            React.createElement('div', {
              className: 'bg-white p-6 rounded-lg max-w-sm w-full'
            },
              React.createElement('h3', {
                className: 'text-lg font-medium mb-4'
              }, 'ã‚¿ã‚¹ã‚¯å®Œäº†ï¼'),
              React.createElement('div', {
                className: 'mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded'
              },
                React.createElement('div', {
                  className: 'text-sm text-gray-600 mb-1'
                }, 'å–ã‚Šçµ„ã‚“ã èª²é¡Œ:'),
                React.createElement('div', {
                  className: 'text-sm font-medium text-gray-800'
                }, currentTaskReason)
              ),
              React.createElement('div', {
                className: 'mb-4'
              },
                React.createElement('label', {
                  className: 'block text-sm font-medium text-gray-700 mb-2'
                }, 'å®Ÿéš›ã«ä½•ã‚’ã©ã“ã¾ã§ã‚„ã‚Šã¾ã—ãŸã‹ï¼Ÿ'),
                React.createElement('textarea', {
                  value: taskResult,
                  onChange: (e) => setTaskResult(e.target.value),
                  className: 'w-full p-3 border border-gray-300 rounded-lg resize-none',
                  rows: 3,
                  placeholder: 'ä¾‹ï¼š7äººåˆ†ã®é€€é™¢ã‚µãƒãƒªã‚’ä½œæˆå®Œäº†'
                })
              ),
              React.createElement('div', {
                className: 'flex space-x-2'
              },
                React.createElement('button', {
                  onClick: handleTaskComplete,
                  className: 'flex-1 py-2 px-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors'
                }, 'è¨˜éŒ²ã™ã‚‹')
              )
            )
          ),
        )
      );
    };

    ReactDOM.render(React.createElement(AdaptivePomodoro), document.getElementById('root'));
